%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
\edef\sphinxdqmaybe{\ifdefined\DeclareUnicodeCharacterAsOptional\string"\fi}
  \DeclareUnicodeCharacter{\sphinxdqmaybe00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{\sphinxdqmaybe2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{\sphinxdqmaybe2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{\sphinxdqmaybe2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{\sphinxdqmaybe251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{\sphinxdqmaybe2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}
\usepackage{times}
\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}
\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\addto\captionsenglish{\renewcommand{\figurename}{Fig.\@ }}
\makeatletter
\def\fnum@figure{\figurename\thefigure{}}
\makeatother
\addto\captionsenglish{\renewcommand{\tablename}{Table }}
\makeatletter
\def\fnum@table{\tablename\thetable{}}
\makeatother
\addto\captionsenglish{\renewcommand{\literalblockname}{Listing}}

\addto\captionsenglish{\renewcommand{\literalblockcontinuedname}{continued from previous page}}
\addto\captionsenglish{\renewcommand{\literalblockcontinuesname}{continues on next page}}
\addto\captionsenglish{\renewcommand{\sphinxnonalphabeticalgroupname}{Non-alphabetical}}
\addto\captionsenglish{\renewcommand{\sphinxsymbolsname}{Symbols}}
\addto\captionsenglish{\renewcommand{\sphinxnumbersname}{Numbers}}

\addto\extrasenglish{\def\pageautorefname{page}}

\setcounter{tocdepth}{1}



\title{Industrial Metals Forecaster Documentation}
\date{Aug 09, 2019}
\release{1.0.0}
\author{Oliver Boom}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}



\chapter{Preprocessing Module}
\label{\detokenize{index:module-Src.preprocessing}}\label{\detokenize{index:preprocessing-module}}\index{Src.preprocessing (module)@\spxentry{Src.preprocessing}\spxextra{module}}\index{clean\_data() (in module Src.preprocessing)@\spxentry{clean\_data()}\spxextra{in module Src.preprocessing}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.preprocessing.clean_data}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.preprocessing.}}\sphinxbfcode{\sphinxupquote{clean\_data}}}{\emph{df}, \emph{n\_std=20}}{}
Removes any outliers that are further than a chosen
number of standard deviations from the mean
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{df}} (\sphinxstyleliteralemphasis{\sphinxupquote{dataframe}}) \textendash{} the finacial time series

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{n\_std}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the number of standard deviations from the mean

\end{itemize}

\item[{Returns}] \leavevmode
the cleaned financial time series

\item[{Return type}] \leavevmode
dataframe

\end{description}\end{quote}

\end{fulllineitems}

\index{clean\_dict\_gen() (in module Src.preprocessing)@\spxentry{clean\_dict\_gen()}\spxextra{in module Src.preprocessing}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.preprocessing.clean_dict_gen}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.preprocessing.}}\sphinxbfcode{\sphinxupquote{clean\_dict\_gen}}}{\emph{universe\_dict}}{}
Returns a dictionary of cleaned dataframes
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{universe\_dict}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} a dictionary of financial time series

\item[{Returns}] \leavevmode
the cleaned financial time series

\item[{Return type}] \leavevmode
dict

\end{description}\end{quote}

\end{fulllineitems}

\index{column\_rename() (in module Src.preprocessing)@\spxentry{column\_rename()}\spxextra{in module Src.preprocessing}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.preprocessing.column_rename}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.preprocessing.}}\sphinxbfcode{\sphinxupquote{column\_rename}}}{\emph{universe\_dict}}{}
Appends the name of the instrument
name to the columns
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{universe\_dict}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} a dictionary of financial time series

\item[{Returns}] \leavevmode
the financial time series

\item[{Return type}] \leavevmode
dict

\end{description}\end{quote}

\end{fulllineitems}

\index{dimension\_reduce() (in module Src.preprocessing)@\spxentry{dimension\_reduce()}\spxextra{in module Src.preprocessing}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.preprocessing.dimension_reduce}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.preprocessing.}}\sphinxbfcode{\sphinxupquote{dimension\_reduce}}}{\emph{data\_X}, \emph{n\_dim}}{}
Performing PCA to reduce the amount of
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{data\_X}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} array to perform reduction on

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{n\_dim}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} number of dimensions to reduce to

\end{itemize}

\item[{Returns}] \leavevmode
reduced dataset

\item[{Return type}] \leavevmode
np.array

\end{description}\end{quote}

\end{fulllineitems}

\index{dimension\_selector() (in module Src.preprocessing)@\spxentry{dimension\_selector()}\spxextra{in module Src.preprocessing}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.preprocessing.dimension_selector}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.preprocessing.}}\sphinxbfcode{\sphinxupquote{dimension\_selector}}}{\emph{data\_X}, \emph{thresh=0.98}}{}
Returns the number of dimensions that reaches the
threshold level of desired variance
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{data\_X}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} dataset to perform reduction on

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{thresh}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} the amount of variance that must be contained in reduced dataset

\end{itemize}

\item[{Returns}] \leavevmode
the amount of dimensions needed to conatin the threshold variance

\item[{Return type}] \leavevmode
int

\end{description}\end{quote}

\end{fulllineitems}

\index{feature\_spawn() (in module Src.preprocessing)@\spxentry{feature\_spawn()}\spxextra{in module Src.preprocessing}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.preprocessing.feature_spawn}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.preprocessing.}}\sphinxbfcode{\sphinxupquote{feature\_spawn}}}{\emph{df}}{}
Spawns features for each instrument
Returns df with the following columns for each
instrument
Log Returns
EWMA 1 day
EWMA 1 week
EWMA 1 month
EWMA 1 quarter
EWMA 6 months
EWMA 1 year
Rolling vol 1 week
Rolling vol 1 month
Rolling vol 1 quarter

\end{fulllineitems}

\index{generate\_dataset() (in module Src.preprocessing)@\spxentry{generate\_dataset()}\spxextra{in module Src.preprocessing}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.preprocessing.generate_dataset}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.preprocessing.}}\sphinxbfcode{\sphinxupquote{generate\_dataset}}}{\emph{universe\_dict}, \emph{lag=5}, \emph{lg\_returns\_only=True}, \emph{price\_only=False}}{}
Generates the full dataset
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{universe\_dict}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} a dictionary of financial time series

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{lag}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the amount of days the returns are calculated between

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{lg\_returns\_only}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} whether to return a dataset of log returns only

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{price\_only}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} whether to return a dataset of raw prices only

\end{itemize}

\item[{Returns}] \leavevmode
the financial time series

\item[{Return type}] \leavevmode
dataframe

\end{description}\end{quote}

\end{fulllineitems}

\index{generate\_lg\_return() (in module Src.preprocessing)@\spxentry{generate\_lg\_return()}\spxextra{in module Src.preprocessing}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.preprocessing.generate_lg_return}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.preprocessing.}}\sphinxbfcode{\sphinxupquote{generate\_lg\_return}}}{\emph{df\_full}, \emph{lag=1}}{}
Returns a dictionary containing dataframes
with the additional log returns column
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{df\_full}} (\sphinxstyleliteralemphasis{\sphinxupquote{dataframe}}) \textendash{} the financial time series

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{lag}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the amount of days the returns are calculated between

\end{itemize}

\item[{Returns}] \leavevmode
the financial time series with log returns

\item[{Return type}] \leavevmode
dataframe

\end{description}\end{quote}

\end{fulllineitems}

\index{generate\_target() (in module Src.preprocessing)@\spxentry{generate\_target()}\spxextra{in module Src.preprocessing}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.preprocessing.generate_target}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.preprocessing.}}\sphinxbfcode{\sphinxupquote{generate\_target}}}{\emph{df\_full}, \emph{target\_col='price\_cu\_lme'}, \emph{lag=5}}{}
Generate the target variable

\end{fulllineitems}

\index{log\_returns() (in module Src.preprocessing)@\spxentry{log\_returns()}\spxextra{in module Src.preprocessing}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.preprocessing.log_returns}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.preprocessing.}}\sphinxbfcode{\sphinxupquote{log\_returns}}}{\emph{series}, \emph{lag=1}}{}
Calculate log returns between adjacent close prices
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{series}} (\sphinxstyleliteralemphasis{\sphinxupquote{numpy array}}) \textendash{} prices to calculate the log returns on

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{lag}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the amount of days the returns are calculated between

\end{itemize}

\item[{Returns}] \leavevmode
the series of log returns

\item[{Return type}] \leavevmode
numpy array

\end{description}\end{quote}

\end{fulllineitems}

\index{price\_rename() (in module Src.preprocessing)@\spxentry{price\_rename()}\spxextra{in module Src.preprocessing}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.preprocessing.price_rename}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.preprocessing.}}\sphinxbfcode{\sphinxupquote{price\_rename}}}{\emph{universe\_dict}}{}
Renaming the column of the dataframe values to price
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{universe\_dict}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} a dictionary of financial time series

\item[{Returns}] \leavevmode
financial time series

\item[{Return type}] \leavevmode
dict

\end{description}\end{quote}

\end{fulllineitems}

\index{slice\_series() (in module Src.preprocessing)@\spxentry{slice\_series()}\spxextra{in module Src.preprocessing}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.preprocessing.slice_series}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.preprocessing.}}\sphinxbfcode{\sphinxupquote{slice\_series}}}{\emph{data\_X}, \emph{data\_y}, \emph{series\_length}, \emph{dataset\_pct=1.0}}{}
TODO

\end{fulllineitems}

\index{truncate\_window\_length() (in module Src.preprocessing)@\spxentry{truncate\_window\_length()}\spxextra{in module Src.preprocessing}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.preprocessing.truncate_window_length}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.preprocessing.}}\sphinxbfcode{\sphinxupquote{truncate\_window\_length}}}{\emph{universe\_dict}}{}
Chopping the length of all of the dataframes to ensure
that they are all between the same dates
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{universe\_dict}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} the financial time series

\item[{Returns}] \leavevmode
the truncated financial time series

\item[{Return type}] \leavevmode
dict

\end{description}\end{quote}

\end{fulllineitems}

\index{universe\_select() (in module Src.preprocessing)@\spxentry{universe\_select()}\spxextra{in module Src.preprocessing}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.preprocessing.universe_select}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.preprocessing.}}\sphinxbfcode{\sphinxupquote{universe\_select}}}{\emph{path}, \emph{commodity\_name}}{}
Selects the instruments believed to be of
interest for the commodity selected
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{path}} (\sphinxstyleliteralemphasis{\sphinxupquote{type string}}) \textendash{} path to the csv folder

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{commodity\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{type string}}) \textendash{} the name of the metal being inspected

\end{itemize}

\item[{Returns}] \leavevmode
financial time series relevant to the commodity

\item[{Return type}] \leavevmode
dict

\end{description}\end{quote}

\end{fulllineitems}



\chapter{Deeplearning Module}
\label{\detokenize{index:module-Src.deeplearning}}\label{\detokenize{index:deeplearning-module}}\index{Src.deeplearning (module)@\spxentry{Src.deeplearning}\spxextra{module}}\index{DeepLearning (class in Src.deeplearning)@\spxentry{DeepLearning}\spxextra{class in Src.deeplearning}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.deeplearning.DeepLearning}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{Src.deeplearning.}}\sphinxbfcode{\sphinxupquote{DeepLearning}}}{\emph{model}, \emph{data\_X}, \emph{data\_y}, \emph{n\_epochs}, \emph{optimiser}, \emph{batch\_size}, \emph{loss\_function=MSELoss()}, \emph{device='cpu'}, \emph{seed=42}, \emph{debug=True}, \emph{disp\_freq=20}, \emph{fig\_disp\_freq=50}, \emph{early\_stop=True}, \emph{early\_verbose=False}, \emph{patience=50}, \emph{rel\_tol=0}, \emph{scaler\_data\_X=None}, \emph{scaler\_data\_y=None}}{}
Class to perform training and validation for a given model
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{model}} (\sphinxstyleliteralemphasis{\sphinxupquote{LSTM}}) \textendash{} the neural network model

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{data\_X}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} the training dataset

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{data\_y}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} the target dataset

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{n\_epochs}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the number of epochs of training

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{optimiser}} (\sphinxstyleliteralemphasis{\sphinxupquote{torch.optim}}) \textendash{} the type of optimiser used

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{batch\_size}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the batch size

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{loss\_function}} (\sphinxstyleliteralemphasis{\sphinxupquote{torch.nn.modules.loss}}) \textendash{} the loss function used

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{device}} (\sphinxstyleliteralemphasis{\sphinxupquote{string}}) \textendash{} running on cpu or CUDA

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{seed}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the random seed set

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{debug}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} whether to print some parameters for checking

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{disp\_freq}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the frequency that training/validation metrics will be printed

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{fig\_disp\_freq}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the frequency that training/validation prediction figures will be made

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{early\_stop}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} whether early stopping is utilized

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{early\_verbose}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} whether to print out the early stopping counter

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{patience}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the amount of epochs without improvement before stopping

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{rel\_tol}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} the relative improvement percentage that must be achieved

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{scaler\_data\_X}} \textendash{} the data X scaler object for inverse scaling

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{scaler\_data\_y}} \textendash{} the dataX y scaler object for inverse scaling

\end{itemize}

\item[{Rtype scaler\_data\_X}] \leavevmode
sklearn.preprocessing.data.MinMaxScaler

\item[{Rtype scaler\_data\_y}] \leavevmode
sklearn.preprocessing.data.MinMaxScaler

\end{description}\end{quote}
\index{create\_data\_loaders() (Src.deeplearning.DeepLearning method)@\spxentry{create\_data\_loaders()}\spxextra{Src.deeplearning.DeepLearning method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.deeplearning.DeepLearning.create_data_loaders}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{create\_data\_loaders}}}{}{}
Forms iterators to pipeline in the data

\end{fulllineitems}

\index{evaluate() (Src.deeplearning.DeepLearning method)@\spxentry{evaluate()}\spxextra{Src.deeplearning.DeepLearning method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.deeplearning.DeepLearning.evaluate}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{evaluate}}}{\emph{model}, \emph{test\_loader}}{}
Evaluates the performance of the network
on given data for a given model

A lot of overlap of code with validation. Only kept separate
due to inspection of attibutes made easier when running simulations
if kept separate
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{test\_loader}} (\sphinxstyleliteralemphasis{\sphinxupquote{torch.utils.data.dataloader.DataLoader}}) \textendash{} the iterator that feeds in the data of choice

\item[{Returns}] \leavevmode
the error metric for that dataset

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{live\_pred\_plot() (Src.deeplearning.DeepLearning method)@\spxentry{live\_pred\_plot()}\spxextra{Src.deeplearning.DeepLearning method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.deeplearning.DeepLearning.live_pred_plot}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{live\_pred\_plot}}}{}{}
Plots the training predictions, validation predictions
and the live training/validation losses

\end{fulllineitems}

\index{size\_check() (Src.deeplearning.DeepLearning method)@\spxentry{size\_check()}\spxextra{Src.deeplearning.DeepLearning method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.deeplearning.DeepLearning.size_check}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{size\_check}}}{}{}
Checks the size of the datasets

\end{fulllineitems}

\index{train() (Src.deeplearning.DeepLearning method)@\spxentry{train()}\spxextra{Src.deeplearning.DeepLearning method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.deeplearning.DeepLearning.train}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{train}}}{\emph{train\_loader}}{}
Performs a single training cycle and returns the
loss metric for the training dataset
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{train\_loader}} (\sphinxstyleliteralemphasis{\sphinxupquote{torch.utils.data.dataloader.DataLoader}}) \textendash{} the iterator that feeds in the training data

\item[{Returns}] \leavevmode
the error metric for that epoch

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{train\_val\_test() (Src.deeplearning.DeepLearning method)@\spxentry{train\_val\_test()}\spxextra{Src.deeplearning.DeepLearning method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.deeplearning.DeepLearning.train_val_test}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{train\_val\_test}}}{}{}
Splits the dataframes in to a training, validation
and test set and creates torch tensors from the underlying
numpy arrays

\end{fulllineitems}

\index{training\_wrapper() (Src.deeplearning.DeepLearning method)@\spxentry{training\_wrapper()}\spxextra{Src.deeplearning.DeepLearning method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.deeplearning.DeepLearning.training_wrapper}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{training\_wrapper}}}{}{}
The wrapper that performs the training and validation

\end{fulllineitems}

\index{validate() (Src.deeplearning.DeepLearning method)@\spxentry{validate()}\spxextra{Src.deeplearning.DeepLearning method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.deeplearning.DeepLearning.validate}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{validate}}}{\emph{val\_loader}}{}
Evaluates the performance of the network
on unseen validation data
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{val\_loader}} (\sphinxstyleliteralemphasis{\sphinxupquote{torch.utils.data.dataloader.DataLoader}}) \textendash{} the iterator that feeds in the validation data

\item[{Returns}] \leavevmode
the error metric for that epoch

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{early\_stopping (class in Src.deeplearning)@\spxentry{early\_stopping}\spxextra{class in Src.deeplearning}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.deeplearning.early_stopping}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{Src.deeplearning.}}\sphinxbfcode{\sphinxupquote{early\_stopping}}}{\emph{patience}, \emph{rel\_tol}, \emph{verbose=False}}{}
Counter to implement early stopping

If validation accuracy has not relative improved below
a relative tolerance set by the user than it breaks the
training

If rel\_tol is set to 0 it becomes a common counter
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{patience}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the amount of epochs without improvement before stopping

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{rel\_tol}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} the relative improvement percentage that must be achieved

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{verbose}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} whether to print the count number

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{best\_score}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} the best score achieved so far

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{counter}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the amount of epochs without improvement so far

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{stop}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} whether stopping criteria is achieved

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{full\_save() (in module Src.deeplearning)@\spxentry{full\_save()}\spxextra{in module Src.deeplearning}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.deeplearning.full_save}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.deeplearning.}}\sphinxbfcode{\sphinxupquote{full\_save}}}{\emph{model}, \emph{model\_name}, \emph{optimiser}, \emph{num\_epoch}, \emph{learning\_rate}, \emph{momentum}, \emph{weight\_decay}, \emph{use\_lg\_returns}, \emph{PCA\_used}, \emph{data\_X}, \emph{train\_loss}, \emph{val\_loss}, \emph{test\_loss}, \emph{train\_time}, \emph{hidden\_dim}, \emph{mse}, \emph{mae}, \emph{mde}, \emph{path='Models/CSVs/'}}{}
Saves the models weights and hyperparameters to a pth file and csv file

\end{fulllineitems}

\index{model\_load() (in module Src.deeplearning)@\spxentry{model\_load()}\spxextra{in module Src.deeplearning}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.deeplearning.model_load}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.deeplearning.}}\sphinxbfcode{\sphinxupquote{model\_load}}}{\emph{model\_name}, \emph{path='Models/'}}{}
Loading function for models from google drive

\end{fulllineitems}

\index{model\_save() (in module Src.deeplearning)@\spxentry{model\_save()}\spxextra{in module Src.deeplearning}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.deeplearning.model_save}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.deeplearning.}}\sphinxbfcode{\sphinxupquote{model\_save}}}{\emph{model}, \emph{name}, \emph{path='Models/'}}{}
Saving function to keep track of models

\end{fulllineitems}

\index{param\_strip() (in module Src.deeplearning)@\spxentry{param\_strip()}\spxextra{in module Src.deeplearning}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.deeplearning.param_strip}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.deeplearning.}}\sphinxbfcode{\sphinxupquote{param\_strip}}}{\emph{param}}{}
Strips the key text info out of certain parameters

\end{fulllineitems}

\index{set\_seed() (in module Src.deeplearning)@\spxentry{set\_seed()}\spxextra{in module Src.deeplearning}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.deeplearning.set_seed}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.deeplearning.}}\sphinxbfcode{\sphinxupquote{set\_seed}}}{\emph{seed}, \emph{device='cpu'}}{}
Sets the random seeds to ensure detemrinistic behaviour
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{seed}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the random seed number that is set

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{device}} (\sphinxstyleliteralemphasis{\sphinxupquote{string}}) \textendash{} whether running on cpu or CUDA

\end{itemize}

\item[{Returns}] \leavevmode
confirmation that seeds have been set

\item[{Return type}] \leavevmode
bool

\end{description}\end{quote}

\end{fulllineitems}



\chapter{Utils Module}
\label{\detokenize{index:module-Src.utils}}\label{\detokenize{index:utils-module}}\index{Src.utils (module)@\spxentry{Src.utils}\spxextra{module}}\index{check\_day\_frequency() (in module Src.utils)@\spxentry{check\_day\_frequency()}\spxextra{in module Src.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.utils.check_day_frequency}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.utils.}}\sphinxbfcode{\sphinxupquote{check\_day\_frequency}}}{\emph{df}, \emph{day\_col\_name='ds'}}{}
Returns a barchart showing the frequency of the
days of the week within a dataframe
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{df}} (\sphinxstyleliteralemphasis{\sphinxupquote{pd.DataFrame}}) \textendash{} the time series to visualise

\end{description}\end{quote}

\end{fulllineitems}

\index{check\_length() (in module Src.utils)@\spxentry{check\_length()}\spxextra{in module Src.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.utils.check_length}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.utils.}}\sphinxbfcode{\sphinxupquote{check\_length}}}{\emph{universe\_dict}}{}
Checks the name of all the dataframes in the
dictionary of instruments
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{universe\_dict}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} a dictionary of financial time series

\end{description}\end{quote}

\end{fulllineitems}

\index{df\_std() (in module Src.utils)@\spxentry{df\_std()}\spxextra{in module Src.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.utils.df_std}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.utils.}}\sphinxbfcode{\sphinxupquote{df\_std}}}{\emph{df}, \emph{col\_name}}{}
Returns the standard deviation of a dataframes column
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{df}} (\sphinxstyleliteralemphasis{\sphinxupquote{pd.DataFrame}}) \textendash{} a dataframe of time series

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{col\_name}} \textendash{} the column of interest

\end{itemize}

\item[{Returns}] \leavevmode
the standard deviation of the series on interest

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{evaluate() (in module Src.utils)@\spxentry{evaluate()}\spxextra{in module Src.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.utils.evaluate}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.utils.}}\sphinxbfcode{\sphinxupquote{evaluate}}}{\emph{y\_true}, \emph{y\_pred}, \emph{log\_ret=False}}{}
Calculated the error metric for a dataframe
of predictions and observed values
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} The observed values

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{y\_pred}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} The predicted values

\end{itemize}

\item[{Return mse, mae, mde}] \leavevmode
Returns the mean squared error, mean absolute accuracy and mean directional accuracy metrics

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{inverse\_log\_returns() (in module Src.utils)@\spxentry{inverse\_log\_returns()}\spxextra{in module Src.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.utils.inverse_log_returns}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.utils.}}\sphinxbfcode{\sphinxupquote{inverse\_log\_returns}}}{\emph{original\_prices}, \emph{log\_returns}, \emph{lag=5}, \emph{shift=0}}{}
Takes a dataframes of predicted log returns and original
prices and returns an array of predicted absolute prices
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{original\_prices}} (\sphinxstyleliteralemphasis{\sphinxupquote{pd.DataFrame}}) \textendash{} a dataframe of absolute prices

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{log\_returns}} (\sphinxstyleliteralemphasis{\sphinxupquote{pd.DataFrame}}) \textendash{} a dataframe of log returns

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{lag}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the lag duration of the log returns

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{shift}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} whether to offset the series forwards of backwards

\end{itemize}

\item[{Returns}] \leavevmode
the raw prices indicated by the log returns

\item[{Return type}] \leavevmode
pd.Series

\end{description}\end{quote}

\end{fulllineitems}

\index{mean\_absolute\_percentage\_error() (in module Src.utils)@\spxentry{mean\_absolute\_percentage\_error()}\spxextra{in module Src.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.utils.mean_absolute_percentage_error}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.utils.}}\sphinxbfcode{\sphinxupquote{mean\_absolute\_percentage\_error}}}{\emph{y\_true}, \emph{y\_pred}}{}
Calculated the mean absolute percentage error metric
between two arrays
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} The observed values

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{y\_pred}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}) \textendash{} The predicted values

\end{itemize}

\item[{Returns}] \leavevmode
The mean absolute percentage error of the series

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{mean\_directional\_accuracy() (in module Src.utils)@\spxentry{mean\_directional\_accuracy()}\spxextra{in module Src.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.utils.mean_directional_accuracy}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.utils.}}\sphinxbfcode{\sphinxupquote{mean\_directional\_accuracy}}}{\emph{y\_true}, \emph{y\_pred}}{}
Calculated the mean directional accuracy
error metric between two series
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{pd.Series}}) \textendash{} The observed values

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{y\_pred}} (\sphinxstyleliteralemphasis{\sphinxupquote{pd.Series}}) \textendash{} The predicted values

\end{itemize}

\item[{Returns}] \leavevmode
The mean direcional accuracy of the series

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{mean\_directional\_accuracy\_log\_ret() (in module Src.utils)@\spxentry{mean\_directional\_accuracy\_log\_ret()}\spxextra{in module Src.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.utils.mean_directional_accuracy_log_ret}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.utils.}}\sphinxbfcode{\sphinxupquote{mean\_directional\_accuracy\_log\_ret}}}{\emph{y\_true}, \emph{y\_pred}}{}
Calculated the mean directional accuracy
error metric between two log return series
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{pd.Series}}) \textendash{} The observed values

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{y\_pred}} (\sphinxstyleliteralemphasis{\sphinxupquote{pd.Series}}) \textendash{} The predicted values

\end{itemize}

\item[{Returns}] \leavevmode
The mean direcional accuracy of the series

\item[{Return type}] \leavevmode
float

\end{description}\end{quote}

\end{fulllineitems}

\index{visualise\_df() (in module Src.utils)@\spxentry{visualise\_df()}\spxextra{in module Src.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.utils.visualise_df}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.utils.}}\sphinxbfcode{\sphinxupquote{visualise\_df}}}{\emph{df}}{}
Visualises the features for an instrument
:param df: the time series to visualise
:type df: pd.DataFrame

\end{fulllineitems}

\index{visualise\_universe() (in module Src.utils)@\spxentry{visualise\_universe()}\spxextra{in module Src.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{index:Src.utils.visualise_universe}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{Src.utils.}}\sphinxbfcode{\sphinxupquote{visualise\_universe}}}{\emph{universe\_dict}}{}
Plots the price and log return for every
instrument in the univese dictionary
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{universe\_dict}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} a dictionary of financial time series to visualise

\end{description}\end{quote}

\end{fulllineitems}



\section{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}


\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{s}
\item\relax\sphinxstyleindexentry{Src.deeplearning}\sphinxstyleindexpageref{index:\detokenize{module-Src.deeplearning}}
\item\relax\sphinxstyleindexentry{Src.preprocessing}\sphinxstyleindexpageref{index:\detokenize{module-Src.preprocessing}}
\item\relax\sphinxstyleindexentry{Src.utils}\sphinxstyleindexpageref{index:\detokenize{module-Src.utils}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}