

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Welcome to Foresights documentation! &mdash; Industrial Metals Forecaster 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> Industrial Metals Forecaster
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Welcome to Foresights documentation!</a><ul>
<li><a class="reference internal" href="#what-is-foresight">What is Foresight</a></li>
<li><a class="reference internal" href="#requirements-and-installation">Requirements and Installation</a></li>
<li><a class="reference internal" href="#examples-and-usage">Examples and Usage</a></li>
<li><a class="reference internal" href="#module-Foresight.preprocessing">Preprocessing Module</a></li>
<li><a class="reference internal" href="#module-Foresight.deeplearning">Deeplearning Module</a></li>
<li><a class="reference internal" href="#module-Foresight.eval_inspect">Evaluation and Inspection Module</a></li>
<li><a class="reference internal" href="#module-Foresight.models">Models Module</a><ul>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Industrial Metals Forecaster</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>Welcome to Foresights documentation!</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="welcome-to-foresights-documentation">
<h1>Welcome to Foresights documentation!<a class="headerlink" href="#welcome-to-foresights-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="what-is-foresight">
<h2>What is Foresight<a class="headerlink" href="#what-is-foresight" title="Permalink to this headline">¶</a></h2>
<p>Foresight is a collection of tools built to forecast the future price movements of industrial metals, using Long Short Term Memory networks. It can take univariate or multi-variate datasets and can make predictions using single-input single-output (SISO), multi-input single-output (MISO) or multi-input multi-output (MIMO) frameworks.</p>
<p>It was built for the purpose of testing the hypothesis that improved predictive performance can be achieved by applying the multi-task learning paradigm to commodity forecasting. As such many of the examples are built for this purpose.</p>
<p>However the tools can equally be applied to any user chosen datasets, provided the datasets are loaded in the format shown in the example csvs. Or are inputed directly as shown in the Proof of Concept (POC) notebooks.</p>
</div>
<div class="section" id="requirements-and-installation">
<h2>Requirements and Installation<a class="headerlink" href="#requirements-and-installation" title="Permalink to this headline">¶</a></h2>
<p>To install</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">msc</span><span class="o">-</span><span class="n">acse</span><span class="o">/</span><span class="n">acse</span><span class="o">-</span><span class="mi">9</span><span class="o">-</span><span class="n">independent</span><span class="o">-</span><span class="n">research</span><span class="o">-</span><span class="n">project</span><span class="o">-</span><span class="n">OliverJBoom</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>Requirements:</p>
<ul class="simple">
<li>numpy==1.16.2</li>
<li>pandas==0.24.2</li>
<li>pmdarima==1.2.1</li>
<li>matplotlib==3.0.3</li>
<li>psycopg2==2.7.6.1</li>
<li>scikit-learn==0.20.3</li>
<li>statsmodels==0.9.0</li>
<li>torch==1.1.0</li>
</ul>
</div>
<div class="section" id="examples-and-usage">
<h2>Examples and Usage<a class="headerlink" href="#examples-and-usage" title="Permalink to this headline">¶</a></h2>
<p>Generic regression examples for univariate and multi-variate problems are contained within the POC (proof of concept) notebooks.</p>
<p>For examples relating to industrial metal forecasting, univariate and multivariate examples can be found in the LSTM notebook, while a multi-task learning example can be found in the LSTM MTL notebook.</p>
</div>
<div class="section" id="module-Foresight.preprocessing">
<span id="preprocessing-module"></span><h2>Preprocessing Module<a class="headerlink" href="#module-Foresight.preprocessing" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="Foresight.preprocessing.clean_data">
<code class="descclassname">Foresight.preprocessing.</code><code class="descname">clean_data</code><span class="sig-paren">(</span><em>df</em>, <em>n_std=20</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/preprocessing.html#clean_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.preprocessing.clean_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes any outliers that are further than a chosen
number of standard deviations from the mean.</p>
<p>These values are most likely wrongly inputted data,
and so are forward filled.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df</strong> (<em>pd.DataFrame</em>) – A time series</li>
<li><strong>n_std</strong> (<em>int</em>) – The number of standard deviations from the mean</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The cleaned time series</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pd.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.preprocessing.clean_dict_gen">
<code class="descclassname">Foresight.preprocessing.</code><code class="descname">clean_dict_gen</code><span class="sig-paren">(</span><em>universe_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/preprocessing.html#clean_dict_gen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.preprocessing.clean_dict_gen" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a dictionary of cleaned DataFrames</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>universe_dict</strong> (<em>dict</em>) – The dictionary of time series</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The cleaned dictionary of time series</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.preprocessing.column_rename">
<code class="descclassname">Foresight.preprocessing.</code><code class="descname">column_rename</code><span class="sig-paren">(</span><em>universe_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/preprocessing.html#column_rename"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.preprocessing.column_rename" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends the name of the instrument to the columns.
To help keep track of the instruments in the full dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>universe_dict</strong> (<em>dict</em>) – The dictionary of time series</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The dictionary of time series</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.preprocessing.dimension_reduce">
<code class="descclassname">Foresight.preprocessing.</code><code class="descname">dimension_reduce</code><span class="sig-paren">(</span><em>data_X</em>, <em>n_dim</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/preprocessing.html#dimension_reduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.preprocessing.dimension_reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Performing PCA to reduce the dimensionality of the data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data_X</strong> (<em>np.array</em>) – The dataset to perform reduction on</li>
<li><strong>n_dim</strong> (<em>int</em>) – Number of dimensions to reduce to</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The reduced dataset</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.preprocessing.dimension_selector">
<code class="descclassname">Foresight.preprocessing.</code><code class="descname">dimension_selector</code><span class="sig-paren">(</span><em>data_X</em>, <em>thresh=0.98</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/preprocessing.html#dimension_selector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.preprocessing.dimension_selector" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculated the number of dimensions required to reach a threshold level
of variance.</p>
<p>Completes a PCA reduction to an increasing number of dimensions
and calculates the total variance achieved for each reduction. If the
reduction is above the threshold then that number of dimensions is returned</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data_X</strong> (<em>np.array</em>) – The dataset to perform reduction on</li>
<li><strong>thresh</strong> (<em>float</em>) – The amount of variance that must be
contained the in reduced dataset</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The column dimensionality required to
contain the threshold variance</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.preprocessing.feature_spawn">
<code class="descclassname">Foresight.preprocessing.</code><code class="descname">feature_spawn</code><span class="sig-paren">(</span><em>df</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/preprocessing.html#feature_spawn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.preprocessing.feature_spawn" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a time series and spawns several new features that explicitly
detail information about the series.</p>
<p>The DataFrame spawned contains the following features
spawned for each column in the input DataFrame:</p>
<blockquote>
<div><dl class="docutils">
<dt>Exponentially Weighted Moving Average of various half lives:</dt>
<dd>Half Life:      1 day
Half Life:      1 week
Half Life:      1 month
Half Life:      1 quarter
Half Life:      6 months
Half Life:      1 year</dd>
<dt>Rolling vol of different window sizes:</dt>
<dd>Window Size:    1 week
Window Size:    1 month
Window Size:    1 quarter</dd>
</dl>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>df</strong> (<em>pd.DataFrame</em>) – The dataset of independent variables</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The DataFrame containing spawned features</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pd.DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.preprocessing.generate_dataset">
<code class="descclassname">Foresight.preprocessing.</code><code class="descname">generate_dataset</code><span class="sig-paren">(</span><em>universe_dict</em>, <em>price_only=True</em>, <em>lg_only=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/preprocessing.html#generate_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.preprocessing.generate_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the full dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>universe_dict</strong> (<em>dict</em>) – The dictionary of time series</li>
<li><strong>lag</strong> (<em>int</em>) – The lag in days between series</li>
<li><strong>lg_only</strong> (<em>bool</em>) – Whether to return a dataset of log returns only</li>
<li><strong>price_only</strong> (<em>bool</em>) – Whether to return a dataset of raw prices only</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The time series</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pd.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.preprocessing.generate_lg_return">
<code class="descclassname">Foresight.preprocessing.</code><code class="descname">generate_lg_return</code><span class="sig-paren">(</span><em>df_full</em>, <em>lag=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/preprocessing.html#generate_lg_return"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.preprocessing.generate_lg_return" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the log return series for each column in the DataFrame
and returns the full dataset with log returns.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df_full</strong> (<em>pd.DataFrame</em>) – The time series</li>
<li><strong>lag</strong> (<em>int</em>) – The lag between the series (in days)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The DataFrame of time series with log returns</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pd.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.preprocessing.log_returns">
<code class="descclassname">Foresight.preprocessing.</code><code class="descname">log_returns</code><span class="sig-paren">(</span><em>series</em>, <em>lag=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/preprocessing.html#log_returns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.preprocessing.log_returns" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the log returns between adjacent close prices.
A constant lag is used across the whole series.
E.g a lag of one means a day to day log return.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>series</strong> (<em>np.array</em>) – Prices to calculate the log returns on</li>
<li><strong>lag</strong> (<em>int</em>) – The lag between the series (in days)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The series of log returns</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.preprocessing.price_rename">
<code class="descclassname">Foresight.preprocessing.</code><code class="descname">price_rename</code><span class="sig-paren">(</span><em>universe_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/preprocessing.html#price_rename"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.preprocessing.price_rename" title="Permalink to this definition">¶</a></dt>
<dd><p>Renaming the column of the DataFrame values to price.
This is actually the market closing price of the time series.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>universe_dict</strong> (<em>dict</em>) – The dictionary of time series</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The dictionary of renamed time series</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.preprocessing.slice_series">
<code class="descclassname">Foresight.preprocessing.</code><code class="descname">slice_series</code><span class="sig-paren">(</span><em>data_X</em>, <em>data_y</em>, <em>series_len</em>, <em>dataset_pct=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/preprocessing.html#slice_series"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.preprocessing.slice_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Slices the train and target dataset time series.</p>
<p>Turns each time series into a series of time series, with each series
displaced by one step forward to the previous series. And for each
of these windows there is an accompanying target value</p>
<p>The effect of this is to create an array of time series (which is the depth
equal to the amount of instruments in the dataset) with each entry in this
array having a target series in the data_y array</p>
<p>The resulting data_X array shape:
[amount of rolling windows, length of each series, number of instruments]</p>
<p>The resulting data_y array shape:
[amount of rolling windows, number of instruments]</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data_X</strong> (<em>np.array</em>) – The dataset of time series</li>
<li><strong>data_y</strong> (<em>np.array</em>) – The target dataset of time series</li>
<li><strong>series_len</strong> (<em>int</em>) – The length of each time series window</li>
<li><strong>dataset_pct</strong> (<em>float</em>) – The percentage of the full dataset to include</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.preprocessing.truncate_window_length">
<code class="descclassname">Foresight.preprocessing.</code><code class="descname">truncate_window_length</code><span class="sig-paren">(</span><em>universe_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/preprocessing.html#truncate_window_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.preprocessing.truncate_window_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Chopping the length of all of the DataFrames to ensure
that they are all between the same dates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>universe_dict</strong> (<em>dict</em>) – The dictionary of time series</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the dictionary of truncated time series</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.preprocessing.universe_select">
<code class="descclassname">Foresight.preprocessing.</code><code class="descname">universe_select</code><span class="sig-paren">(</span><em>path</em>, <em>commodity_name</em>, <em>custom_list=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/preprocessing.html#universe_select"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.preprocessing.universe_select" title="Permalink to this definition">¶</a></dt>
<dd><p>Selects the financial time series relevant for the commodities selected.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<em>string</em>) – path to the folder containing csvs</li>
<li><strong>commodity_name</strong> (<em>string</em>) – the name of the metal/s being inspected</li>
<li><strong>custom_list</strong> (<em>list</em>) – the names of csvs to be included in the dataset</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The time series relevant to the commodities</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-Foresight.deeplearning">
<span id="deeplearning-module"></span><h2>Deeplearning Module<a class="headerlink" href="#module-Foresight.deeplearning" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="Foresight.deeplearning.DeepLearning">
<em class="property">class </em><code class="descclassname">Foresight.deeplearning.</code><code class="descname">DeepLearning</code><span class="sig-paren">(</span><em>model</em>, <em>data_X</em>, <em>data_y</em>, <em>optimiser</em>, <em>batch_size=128</em>, <em>n_epochs=100</em>, <em>loss_function=MSELoss()</em>, <em>device='cpu'</em>, <em>seed=42</em>, <em>debug=True</em>, <em>disp_freq=20</em>, <em>fig_disp_freq=50</em>, <em>early_stop=True</em>, <em>early_verbose=False</em>, <em>patience=50</em>, <em>rel_tol=0</em>, <em>scaler_data_X=None</em>, <em>scaler_data_y=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/deeplearning.html#DeepLearning"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.deeplearning.DeepLearning" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to perform training and validation for a given model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> (<em>nn.module</em>) – The neural network model</li>
<li><strong>data_X</strong> (<em>np.array</em>) – The training dataset</li>
<li><strong>data_y</strong> (<em>np.array</em>) – the target dataset</li>
<li><strong>n_epochs</strong> (<em>int</em>) – The number of epochs of training</li>
<li><strong>optimiser</strong> (<em>torch.optim</em>) – The type of optimiser used</li>
<li><strong>batch_size</strong> (<em>int</em>) – The batch size</li>
<li><strong>loss_function</strong> (<em>torch.nn.modules.loss</em>) – The loss function used</li>
<li><strong>device</strong> (<em>string</em>) – The device to run on (Cpu or CUDA)</li>
<li><strong>seed</strong> (<em>int</em>) – The number that is set for the random seeds</li>
<li><strong>debug</strong> (<em>bool</em>) – Whether to print some parameters for checking</li>
<li><strong>disp_freq</strong> (<em>int</em>) – The epoch frequency that training/validation
metrics will be printed on</li>
<li><strong>fig_disp_freq</strong> (<em>int</em>) – The frequency that training/validation prediction
figures will be made</li>
<li><strong>early_stop</strong> (<em>bool</em>) – Whether early stopping is utilized</li>
<li><strong>early_verbose</strong> (<em>bool</em>) – Whether to print out the early stopping counter</li>
<li><strong>patience</strong> (<em>stopping int</em>) – The amount of epochs without improvement before</li>
<li><strong>rel_tol</strong> – The relative improvement percentage that must be
achieved float</li>
<li><strong>scaler_data_X</strong> (<em>sklearn.preprocessing.data.MinMaxScaler</em>) – The data X scaler object for inverse scaling</li>
<li><strong>scaler_data_y</strong> (<em>sklearn.preprocessing.data.MinMaxScaler</em>) – The dataX y scaler object for inverse scaling</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="Foresight.deeplearning.DeepLearning.create_data_loaders">
<code class="descname">create_data_loaders</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/deeplearning.html#DeepLearning.create_data_loaders"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.deeplearning.DeepLearning.create_data_loaders" title="Permalink to this definition">¶</a></dt>
<dd><p>Forms iterators to pipeline in the data/labels</p>
</dd></dl>

<dl class="method">
<dt id="Foresight.deeplearning.DeepLearning.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><em>model</em>, <em>test_loader</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/deeplearning.html#DeepLearning.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.deeplearning.DeepLearning.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the performance of the network on given data for a given
model.</p>
<p>A lot of overlap of code with validation. Only kept separate due to the
inspection of attributes being made easier when running simulations
if kept separate.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>model</strong> (<em>nn.module</em>) – The model to evaluate</li>
<li><strong>test_loader</strong> (<em>torch.utils.data.dataloader.DataLoader</em>) – The iterator that feeds in the data of choice</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The error metric for that dataset</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Foresight.deeplearning.DeepLearning.live_pred_plot">
<code class="descname">live_pred_plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/deeplearning.html#DeepLearning.live_pred_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.deeplearning.DeepLearning.live_pred_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the training predictions, validation predictions and the
training/validation losses as they are predicted.</p>
</dd></dl>

<dl class="method">
<dt id="Foresight.deeplearning.DeepLearning.size_check">
<code class="descname">size_check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/deeplearning.html#DeepLearning.size_check"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.deeplearning.DeepLearning.size_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the size of the datasets</p>
</dd></dl>

<dl class="method">
<dt id="Foresight.deeplearning.DeepLearning.train">
<code class="descname">train</code><span class="sig-paren">(</span><em>train_loader</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/deeplearning.html#DeepLearning.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.deeplearning.DeepLearning.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a single training epoch and returns the loss metric
for the training dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>train_loader</strong> (<em>torch.utils.data.dataloader.DataLoader</em>) – The iterator that feeds in the training data</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The error metric for that epoch</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Foresight.deeplearning.DeepLearning.train_val_test">
<code class="descname">train_val_test</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/deeplearning.html#DeepLearning.train_val_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.deeplearning.DeepLearning.train_val_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits the DataFrames in to a training, validation
and test set and creates torch tensors from the underlying
numpy arrays</p>
</dd></dl>

<dl class="method">
<dt id="Foresight.deeplearning.DeepLearning.training_wrapper">
<code class="descname">training_wrapper</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/deeplearning.html#DeepLearning.training_wrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.deeplearning.DeepLearning.training_wrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>The wrapper that performs the training and validation</p>
</dd></dl>

<dl class="method">
<dt id="Foresight.deeplearning.DeepLearning.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><em>val_loader</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/deeplearning.html#DeepLearning.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.deeplearning.DeepLearning.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the performance of the network on unseen validation data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>val_loader</strong> (<em>torch.utils.data.dataloader.DataLoader</em>) – the iterator that feeds in the validation data</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the error metric for that epoch</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="Foresight.deeplearning.early_stopping">
<em class="property">class </em><code class="descclassname">Foresight.deeplearning.</code><code class="descname">early_stopping</code><span class="sig-paren">(</span><em>patience</em>, <em>rel_tol</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/deeplearning.html#early_stopping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.deeplearning.early_stopping" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to facilitate early stopping during the training
of neural networks.</p>
<p>When called if the validation accuracy has not relative improved below a
relative tolerance set by the user the a counter is incremented. If the
counter passes a set value then the stop attribute is set to true. This
should be used as a break condition in the training loop.</p>
<p>If rel_tol is set to 0 then the metric just needs to improve from it’s
existing value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>patience</strong> (<em>int</em>) – The amount of epochs without improvement before stopping</li>
<li><strong>rel_tol</strong> (<em>float</em>) – The relative improvement % that must be achieved</li>
<li><strong>verbose</strong> (<em>bool</em>) – Whether to print the count number</li>
<li><strong>best</strong> (<em>float</em>) – The best score achieved so far</li>
<li><strong>counter</strong> (<em>int</em>) – The amount of epochs without improvement so far</li>
<li><strong>stop</strong> (<em>bool</em>) – Whether stopping criteria is achieved</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.deeplearning.full_save">
<code class="descclassname">Foresight.deeplearning.</code><code class="descname">full_save</code><span class="sig-paren">(</span><em>model</em>, <em>model_name</em>, <em>optimiser</em>, <em>num_epoch</em>, <em>learning_rate</em>, <em>momentum</em>, <em>weight_decay</em>, <em>use_lg_returns</em>, <em>PCA_used</em>, <em>data_X</em>, <em>train_loss</em>, <em>val_loss</em>, <em>test_loss</em>, <em>train_time</em>, <em>hidden_dim</em>, <em>mse</em>, <em>mae</em>, <em>mde</em>, <em>path='Models/CSVs/'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/deeplearning.html#full_save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.deeplearning.full_save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the models run details and hyper-parameters to a csv file
:param model:               The model run
:type  model:               nn.module</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model_name</strong> (<em>strin</em>) – The name the model is saved under</li>
<li><strong>optimiser</strong> (<em>torch.optim</em>) – The optimiser type used</li>
<li><strong>num_epoch</strong> (<em>int</em>) – The number of epochs run for</li>
<li><strong>learning_rate</strong> (<em>float</em>) – The learning rate learning hyper-parameter</li>
<li><strong>momentum</strong> (<em>float</em>) – The momentum learning hyper-parameter</li>
<li><strong>weight_decay</strong> (<em>float</em>) – The weight decay learning hyper-parameter</li>
<li><strong>use_lg_returns</strong> (<em>bool</em>) – Whether log returns was used</li>
<li><strong>PCA_used</strong> (<em>bool</em>) – Whether PCA was used</li>
<li><strong>data_X</strong> (<em>np.array</em>) – The training dataset (used to save the shape)</li>
<li><strong>train_loss</strong> (<em>float</em>) – The loss on the training dataset</li>
<li><strong>val_loss</strong> (<em>float</em>) – The loss on the validation dataset</li>
<li><strong>test_loss</strong> (<em>float</em>) – The loss on the test dataset</li>
<li><strong>train_time</strong> (<em>float</em>) – The amount of time to train</li>
<li><strong>hidden_dim</strong> (<em>int</em>) – The number of neurons in the hidden layers</li>
<li><strong>mse</strong> (<em>floot</em>) – The mean squared error metric</li>
<li><strong>mae</strong> (<em>floot</em>) – The mean absolute error metric</li>
<li><strong>mde</strong> (<em>floot</em>) – The mean direction error metric</li>
<li><strong>path</strong> (<em>string</em>) – The directory path to save in</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.deeplearning.model_load">
<code class="descclassname">Foresight.deeplearning.</code><code class="descname">model_load</code><span class="sig-paren">(</span><em>model_name</em>, <em>device</em>, <em>path='Results/Pths/'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/deeplearning.html#model_load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.deeplearning.model_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loading function for the models.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model_name</strong> (<em>string</em>) – The model name to load</li>
<li><strong>path</strong> (<em>string</em>) – The directory path to load the model from</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.deeplearning.model_save">
<code class="descclassname">Foresight.deeplearning.</code><code class="descname">model_save</code><span class="sig-paren">(</span><em>model</em>, <em>name</em>, <em>path='Results/Pths/'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/deeplearning.html#model_save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.deeplearning.model_save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saving function for the model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> (<em>torch.nn</em>) – The model to save</li>
<li><strong>name</strong> (<em>string</em>) – The name to save the model under</li>
<li><strong>path</strong> (<em>string</em>) – The directory path to save the model in</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.deeplearning.param_strip">
<code class="descclassname">Foresight.deeplearning.</code><code class="descname">param_strip</code><span class="sig-paren">(</span><em>param</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/deeplearning.html#param_strip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.deeplearning.param_strip" title="Permalink to this definition">¶</a></dt>
<dd><p>Strips the key text info out of certain parameters.
Used to save the text info of which models/optimiser objects are used</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>param</strong> (<em>object</em>) – The parameter object to find the name of</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.deeplearning.set_seed">
<code class="descclassname">Foresight.deeplearning.</code><code class="descname">set_seed</code><span class="sig-paren">(</span><em>seed</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/deeplearning.html#set_seed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.deeplearning.set_seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the random seeds to ensure deterministic behaviour.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>seed</strong> (<em>int</em>) – The number that is set for the random seeds</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Confirmation that seeds have been set</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-Foresight.eval_inspect">
<span id="evaluation-and-inspection-module"></span><h2>Evaluation and Inspection Module<a class="headerlink" href="#module-Foresight.eval_inspect" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="Foresight.eval_inspect.check_day_frequency">
<code class="descclassname">Foresight.eval_inspect.</code><code class="descname">check_day_frequency</code><span class="sig-paren">(</span><em>df</em>, <em>col_name='ds'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/eval_inspect.html#check_day_frequency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.eval_inspect.check_day_frequency" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a bar chart showing the frequency of the days of the week.</p>
<p>Used to check that only business days are included in the dataset, and
that there is a roughly equal distribution of entries across the week.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>df</strong> (<em>pd.DataFrame</em>) – A DataFrame containing the time series to check</li>
<li><strong>col_name</strong> (<em>string</em>) – The name of the column of interest</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.eval_inspect.check_length">
<code class="descclassname">Foresight.eval_inspect.</code><code class="descname">check_length</code><span class="sig-paren">(</span><em>universe_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/eval_inspect.html#check_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.eval_inspect.check_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the name of all the DataFrames in the dictionary of time series.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>universe_dict</strong> (<em>dict</em>) – The dictionary of time series</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.eval_inspect.df_std">
<code class="descclassname">Foresight.eval_inspect.</code><code class="descname">df_std</code><span class="sig-paren">(</span><em>df</em>, <em>col_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/eval_inspect.html#df_std"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.eval_inspect.df_std" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates standard deviation of a DataFrames column.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df</strong> (<em>pd.DataFrame</em>) – A DataFrame of time series</li>
<li><strong>col_name</strong> (<em>string</em>) – The column of interest</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The standard deviation of the series</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.eval_inspect.evaluate">
<code class="descclassname">Foresight.eval_inspect.</code><code class="descname">evaluate</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em>, <em>log_ret=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/eval_inspect.html#evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.eval_inspect.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the error metrics for between two arrays.</p>
<dl class="docutils">
<dt>The error metrics calculated are:</dt>
<dd>Means Squared Error
Mean Absolute Error
Mean Directional Accuracy</dd>
</dl>
<p>For a log returns series the definition of mean directional accuracy
changes. This is as for a log return series it is the signum values of the
series that details which direction the series has moved. This is as a log
return series is the first difference of the original series. For raw price
The signal needs to be differenced before the signum function is applied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y_true</strong> (<em>np.array</em>) – The observed values</li>
<li><strong>y_pred</strong> (<em>np.array</em>) – The predicted values</li>
<li><strong>log_ret</strong> (<em>bool</em>) – Whether the series compared are log returns</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Return error_metrics:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first">The error metrics of the series</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">List</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.eval_inspect.inverse_log_returns">
<code class="descclassname">Foresight.eval_inspect.</code><code class="descname">inverse_log_returns</code><span class="sig-paren">(</span><em>original_prices</em>, <em>log_returns</em>, <em>lag=5</em>, <em>offset=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/eval_inspect.html#inverse_log_returns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.eval_inspect.inverse_log_returns" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a DataFrame of predicted log returns and original
prices and returns an array of predicted absolute prices</p>
<p>The offset parameter moves the series forwards or backwards to
align the series with the DataFrame it might be appended to.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>original_prices</strong> (<em>pd.DataFrame</em>) – A DataFrame of absolute prices</li>
<li><strong>log_returns</strong> (<em>pd.DataFrame</em>) – A DataFrame of log returns</li>
<li><strong>lag</strong> (<em>int</em>) – The lag in days between series</li>
<li><strong>offset</strong> (<em>int</em>) – Amount to offset the series forwards of backwards</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The raw prices given by the log returns</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pd.Series</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.eval_inspect.mean_absolute_percentage_error">
<code class="descclassname">Foresight.eval_inspect.</code><code class="descname">mean_absolute_percentage_error</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/eval_inspect.html#mean_absolute_percentage_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.eval_inspect.mean_absolute_percentage_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the mean absolute percentage error between two arrays.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y_true</strong> (<em>np.array</em>) – The observed values</li>
<li><strong>y_pred</strong> (<em>np.array</em>) – The predicted values</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The mean absolute percentage error of the series</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.eval_inspect.mean_directional_accuracy">
<code class="descclassname">Foresight.eval_inspect.</code><code class="descname">mean_directional_accuracy</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/eval_inspect.html#mean_directional_accuracy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.eval_inspect.mean_directional_accuracy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculated the mean directional accuracy error metric
between two series.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y_true</strong> (<em>np.array</em>) – The observed values</li>
<li><strong>y_pred</strong> (<em>np.array</em>) – The predicted values</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The mean directional accuracy of the series</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.eval_inspect.mean_directional_accuracy_log_ret">
<code class="descclassname">Foresight.eval_inspect.</code><code class="descname">mean_directional_accuracy_log_ret</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/eval_inspect.html#mean_directional_accuracy_log_ret"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.eval_inspect.mean_directional_accuracy_log_ret" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the mean directional accuracy error metric between
two series of log returns.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y_true</strong> (<em>np.array</em>) – The observed values</li>
<li><strong>y_pred</strong> (<em>np.array</em>) – The predicted values</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The mean directional accuracy of the series</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="Foresight.eval_inspect.visualise_df">
<code class="descclassname">Foresight.eval_inspect.</code><code class="descname">visualise_df</code><span class="sig-paren">(</span><em>df</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/eval_inspect.html#visualise_df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.eval_inspect.visualise_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualises each time series in a DataFrame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>df</strong> (<em>pd.DataFrame</em>) – The DataFrame of time series to visualise</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-Foresight.models">
<span id="models-module"></span><h2>Models Module<a class="headerlink" href="#module-Foresight.models" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="Foresight.models.LSTM">
<em class="property">class </em><code class="descclassname">Foresight.models.</code><code class="descname">LSTM</code><span class="sig-paren">(</span><em>num_features</em>, <em>hidden_dim</em>, <em>dense_hidden</em>, <em>output_dim</em>, <em>batch_size</em>, <em>series_length</em>, <em>device</em>, <em>dropout=0.1</em>, <em>num_layers=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/models.html#LSTM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.models.LSTM" title="Permalink to this definition">¶</a></dt>
<dd><p>A Long Short Term Memory network model with an additional dense layer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>num_features</strong> (<em>int</em>) – The number of features in the dataset</li>
<li><strong>hidden_dim</strong> (<em>int</em>) – The number of neurons in the LSTMs hidden layer/s</li>
<li><strong>dense_hidden</strong> (<em>int</em>) – The number of neurons in the dense layers</li>
<li><strong>output_dim</strong> (<em>int</em>) – The number of neurons in the output layer</li>
<li><strong>batch_size</strong> (<em>int</em>) – The number of items in each batch</li>
<li><strong>series_length</strong> (<em>Int</em>) – The length of the time series</li>
<li><strong>device</strong> (<em>string</em>) – The device to run on (Cpu or CUDA)</li>
<li><strong>dropout</strong> (<em>float</em>) – The probability of dropout</li>
<li><strong>num_layers</strong> (<em>int</em>) – The number of stacked LSTM layers</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="Foresight.models.LSTM.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/models.html#LSTM.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.models.LSTM.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward pass through the neural network</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>torch.Tensor</em>) – The input into the network</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Foresight.models.LSTM.init_hidden">
<code class="descname">init_hidden</code><span class="sig-paren">(</span><em>batch_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Foresight/models.html#LSTM.init_hidden"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Foresight.models.LSTM.init_hidden" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialised the hidden state to be zeros. This clears the hidden
state between batches. If you are running a stateful LSTM then this
needs to be changed.</p>
<p>To change to a stateful LSTM requires not detaching the backprop and
storing the computational graph. This strongly increases runtime and
shouldn’t make a big difference. Hence a stateful LSTM was not used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>batch_size</strong> (<em>string</em>) – The batch size to be zeroed</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<div class="toctree-wrapper compound">
</div>
<div class="section" id="indices-and-tables">
<h3>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Oliver Boom

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>